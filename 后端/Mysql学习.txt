										Mysql学习
mysql 5.7.23 压缩版安装：
将下的压缩包解压到D:\zhangwei\devtools\下：mysql-5.7.23-winx64
在D:\zhangwei\devtools\mysql-5.7.23-winx64\目录下新建文件：my.ini
	[mysqld]
	#设置3306端
	port = 3306
	# 设置mysql的安装目录
	basedir=D:\zhangwei\devtools\mysql-5.7.23-winx64
	# 设置mysql数据库的数据的存放目录
	datadir=D:\zhangwei\devtools\mysql-5.7.23-winx64\data
	# 允许最大连接数
	max_connections=200
	# 服务端使用的字符集默认为8比特编码的latin1字符集
	character-set-server=utf8
	# 创建新表时将使用的默认存储引擎
	default-storage-engine=INNODB
	sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES
	[mysql]
	# 设置mysql客户端默认字符集
	default-character-set=utf8
(踩坑：如果目录是D:\software\mysql-5.7.25-winx64，D:后面的\s会被当成空格，所以需要转义：
D:\\software\mysql-5.7.25-winx64
踩坑：需要在mysql安装目录的bin目录下执行安装命令，其他目录下虽然也可以安装成功，但是会
在以后启动服务时报错。)
配置环境变量：
	MYSQL_HOME		D:\zhangwei\devtools\mysql-5.7.23-winx64\
	path			%MYSQL_HOME%\bin
安装MySQL服务：
	1) 以管理员身份运行cmd，进入mysql根目录E:\Program Files\mysql\mysql-5.7.23-winx64 
	2) 运行mysqld --install，控制台提示Services successfully installed，运行成功。 
		① 如果显示已存在，可以使用mysqld --remove后再次执行 
		② 如果报错，可能是权限不足(没有以管理员身份运行cmd) 
	3) 运行mysqld --initialize，生成data目录 
	4) 运行net start mysql启动服务
可能遇到的问题：
msvcr120.dll文件缺失，无法安装mysql，需要下载：Visual C++ Redistributable Packages for Visual Studio 2013
（直接下载msvcr120.dll好像没起作用）地址：https://www.microsoft.com/zh-CN/download/details.aspx?id=40784
最后一步启动mysql服务报错：发现系统错误2，系统找不到指定的文件：这是因为解压版不会主动去修改注册表，所以需要
手动去修改注册表：
	HKEY_LOCAL_MACHINE - SYSTEM - CurrentControlSet - services - mysql - ImagePath
需要将ImagePath这项的值改为解压的mysqld路径："D:\zhangwei\devtools\mysql-5.7.23-winx64\bin\mysqld" (保留引号)
	


修改密码：
	1) 运行net stop mysql，停止服务 
	2) 运行mysqld --skip-grant-tables，开启无密码模式的MySQL Server 
	3) 开启新终端，运行mysql -u root -p，进入MySQL 
	4) 更新root密码 
		运行update mysql.user set authentication_string=password("root") where user="root"; 
	5) 运行flush privileges，刷新权限 
	6) 运行quit，退出 
	7) 运行mysql -u root -p进入mysql输入密码root 
	8) 更改root密码 
		① SET PASSWORD = PASSWORD('1234') 
		② ALTER USER 'root'@'localhost' PASSWORD EXPIRE NEVER 
		③ FLUSH PRIVILEGES

非安装版本可能会出现时区问题,设置时区：
set global time_zone='+8:00';	
查看时区设置：show variables like '%time_zone%';

mysql数据类型：
	整数型：
		tinyint			-- 1个字节
		smallint 		-- 2个字节
		mediumint		-- 3个字节
		int				-- 4个字节
		bigint			-- 8个字节
		注：id int(4), 这种写法只是指定在id字段字符位长度小于等于4时使用4个字符位宽显示该字段。	
	浮点数型：
		float			-- 4个字节
		double			-- 8个字节
		注：sal double(7,2), 这种写法表示总位数为7位，小数位数为2位，如果小数位数超过2位，将执行5舍6入。处理小数位后如果总位数
超过7位，mysql将抛出错误。小数位数总是会保留2位，如果没有小数位就使用.00占位，所以整数位最多只有5位（不包括符号位）
	decimal类型：用于保存需要保持精度的数据
		decimal			-- MySQL分别为整数和小数部分分配存储空间。 MySQL使用二进制格式存储DECIMAL值。使用4个字节存储9位数字（
不足9位使用4个字节，超出部分规则：剩余1-2位使用1个字节保存，超出3-4位使用2个字节保存，超出5-6位使用3个字节保存，超出7-9个字节使用
4个字节保存）。对于decimal(19,9)，小数部分9位使用4个字节保存，整数部分10使用4+1=5个字节保存。decimal使用4舍5入。
	日期、时间类型：
		year			-- 1个字节，1901 ~ 2155
		time			-- 3个字节，-838:59:59 ~ 838:59:59
		date			-- 3个字节，1000-01-01 ~ 9999-12-3
		datetime		-- 8个字节,yyyy-mm-dd hh:mm:ss
		timestamp		-- 4个字节，1970-01-01 00:00:00 ~ 2038-01-19 03:14:07
	字符串：
		char			-- char(M)，定长M位(字符)，这里的位数和英文、中文无关，所以这个M位不是指的字节，但是char最多只能存256个字节
		varchar			-- varchar(M),变长M位，最多M位，varchar最多可以存65535个字节
		tinytext		-- 最大255B（字节）
		text			-- 最大65KB
		mediumtext		-- 最大16MB
		longtext		-- 最大4GB
		enum			-- 只能保存指定枚举值当中的某个，两个隐含值：null、''
		set				-- 只能保存指定set集合中的某个子集
	二进制：
		bit				-- bit(M) M位长
		binary			-- binary(M) 定长M个字节，最多256个字节
		varbinary		-- varbinary(M) 变长M个字节，最多65535个字节
		tinyblob		-- 最大255B（字节）
		blob			-- 最大65KB
		mediumblob		-- 最大16MB
		longblob		-- 最大4GB
	
	
触发器
	准备：
	create table goods(
		gid int,
		name varchar(),
		num int
	);

	create table orders(
		oid int,
		gid int,
		much int	
	);

	insert into goods values 
	(1,'cat',55),
	(2,'dog',45),
	(3,'pig',50);

# tg1 -- insert插入orders表后同步修改goods表库存

delimiter $
create trigger tg1
after
insert 
on 
orders
for each row
begin
update goods set num=num-new.much where gid=new.gid;
end$
delimiter ;

# tg2 -- update修改orders表前修改goods表库存

delimiter $
create trigger tg2 
before 
update 
on 
orders
for each row
begin 
update goods set num=num+old.much-new.much where gid=old.gid;
end$
delimiter ;

# tg3 -- delete删除orders表后修改goods表库存

delimiter $
create trigger tg3
after 
delete 
on orders 
for each row
begin
update goods set num=num+old.much where gid=old.gid;
end$
delimiter ;

# tg4 -- insert插入orders表前判断much是否大于goods表的num值，如果大于就修改much为goods表的num值

delimiter $
create trigger tg4 
before 
insert 
on 
orders 
for each row
begin
declare snum int;
select num into snum from goods where gid=new.gid;
if new.much>snum then
	set new.much=snum;
end if;
update goods set num=num-new.much where gid=new.gid;
end$
delimiter ;

# for each row 说明
表示操作影响每一行都会执行一次触发器中的sql
mysql、oracle都支持
oracle还可以不写这一条语句，表示一条影响多行的语句只会触发一次触发器中的sql语句
mysql5.5及之前的版本都必须要写这一条语句

分页查询：
	select * from table_name order by id limit rownum,pagesize;